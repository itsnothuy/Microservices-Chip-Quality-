# Environment Configuration Template

# Copy this file to .env and customize for your environment
# DO NOT commit .env files to version control

# ================================
# üöÄ APPLICATION CONFIGURATION
# ================================

# Environment type
ENVIRONMENT=development  # development, staging, production
SERVICE_NAME=chip-quality-platform
VERSION=1.0.0
DEBUG=true

# ================================
# üåê SERVER CONFIGURATION
# ================================

# API Gateway
API_GATEWAY_HOST=0.0.0.0
API_GATEWAY_PORT=8000
API_GATEWAY_WORKERS=4

# Service URLs (internal)
INSPECTION_SERVICE_URL=http://inspection-service:8001
INFERENCE_SERVICE_URL=http://inference-service:8002
ARTIFACT_SERVICE_URL=http://artifact-service:8003
REPORT_SERVICE_URL=http://report-service:8004

# External URLs
EXTERNAL_API_BASE_URL=https://api.manufacturing.company.com
CORS_ORIGINS=["https://quality-dashboard.company.com", "https://manufacturing-portal.company.com"]

# ================================
# üóÑÔ∏è DATABASE CONFIGURATION
# ================================

# PostgreSQL Primary Database
DB_HOST=postgresql-primary
DB_PORT=5432
DB_NAME=chip_quality
DB_USER=chip_quality_user
DB_PASSWORD=your_secure_password_here
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=30
DB_POOL_RECYCLE=3600

# PostgreSQL Read Replica (optional)
DB_READ_REPLICA_HOST=postgresql-replica
DB_READ_REPLICA_PORT=5432

# TimescaleDB Configuration
TIMESCALEDB_ENABLED=true
TIMESCALEDB_CHUNK_TIME_INTERVAL=1h
TIMESCALEDB_COMPRESSION_ENABLED=true
TIMESCALEDB_COMPRESSION_AFTER=7d
TIMESCALEDB_RETENTION_PERIOD=1y

# Database Connection String (alternative to individual vars)
DATABASE_URL=postgresql+asyncpg://chip_quality_user:your_secure_password_here@postgresql-primary:5432/chip_quality

# ================================
# üîê AUTHENTICATION & SECURITY
# ================================

# JWT Configuration
JWT_SECRET_KEY=your-super-secret-jwt-key-minimum-32-characters-long
JWT_ALGORITHM=RS256
JWT_ACCESS_TOKEN_EXPIRE_MINUTES=30
JWT_REFRESH_TOKEN_EXPIRE_DAYS=7
JWT_ISSUER=https://auth.manufacturing.company.com
JWT_AUDIENCE=chip-quality-platform

# OAuth2 Configuration
OAUTH2_TOKEN_URL=/v1/auth/token
OAUTH2_SCOPES=inspections:read,inspections:write,artifacts:read,artifacts:write,inference:execute,reports:read,reports:write,admin:users,admin:system

# LDAP/Active Directory
LDAP_SERVER_URL=ldaps://ldap.company.com:636
LDAP_BIND_DN=cn=chip-quality-service,ou=service-accounts,dc=company,dc=com
LDAP_BIND_PASSWORD=ldap_service_account_password
LDAP_BASE_DN=ou=manufacturing,dc=company,dc=com
LDAP_USER_SEARCH_FILTER=(sAMAccountName={username})
LDAP_GROUP_SEARCH_FILTER=(member={user_dn})

# Security Settings
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60
SESSION_TIMEOUT_MINUTES=480
MAX_LOGIN_ATTEMPTS=5
LOCKOUT_DURATION_MINUTES=15

# ================================
# üì° MESSAGING & EVENTS
# ================================

# Apache Kafka
KAFKA_BOOTSTRAP_SERVERS=kafka-cluster:9092
KAFKA_SECURITY_PROTOCOL=SASL_SSL
KAFKA_SASL_MECHANISM=PLAIN
KAFKA_SASL_USERNAME=chip_quality_producer
KAFKA_SASL_PASSWORD=kafka_password_here
KAFKA_SSL_CA_LOCATION=/etc/ssl/certs/kafka-ca.pem

# Kafka Topics
KAFKA_TOPIC_INSPECTION_EVENTS=chip-quality.inspection.events
KAFKA_TOPIC_INFERENCE_EVENTS=chip-quality.inference.events
KAFKA_TOPIC_AUDIT_EVENTS=chip-quality.audit.events
KAFKA_TOPIC_SYSTEM_EVENTS=chip-quality.system.events

# Schema Registry
SCHEMA_REGISTRY_URL=https://schema-registry.company.com
SCHEMA_REGISTRY_USERNAME=chip_quality_schema
SCHEMA_REGISTRY_PASSWORD=schema_registry_password

# ================================
# ü§ñ NVIDIA TRITON INTEGRATION
# ================================

# Triton Inference Server
TRITON_SERVER_URL=triton-inference-server:8001
TRITON_HTTP_URL=triton-inference-server:8000
TRITON_MODEL_REPOSITORY=/models
TRITON_BATCH_SIZE=4
TRITON_MAX_BATCH_DELAY_MS=100
TRITON_MAX_QUEUE_SIZE=100

# Model Configuration
DEFAULT_DEFECT_MODEL=pcb_defect_detector_v2
MODEL_CONFIDENCE_THRESHOLD=0.7
MODEL_INFERENCE_TIMEOUT=30
MODEL_WARM_UP_ENABLED=true

# GPU Configuration
CUDA_VISIBLE_DEVICES=0,1
NVIDIA_VISIBLE_DEVICES=all
TRITON_LOG_LEVEL=1

# ================================
# üìÅ FILE STORAGE
# ================================

# Object Storage (MinIO/S3)
STORAGE_TYPE=s3  # s3, minio, local
S3_ENDPOINT_URL=https://s3.amazonaws.com
S3_BUCKET_NAME=chip-quality-artifacts
S3_ACCESS_KEY_ID=your_s3_access_key
S3_SECRET_ACCESS_KEY=your_s3_secret_key
S3_REGION=us-west-2

# Local Storage (development only)
LOCAL_STORAGE_PATH=/app/storage
LOCAL_STORAGE_MAX_SIZE_GB=100

# File Upload Limits
MAX_UPLOAD_SIZE_MB=50
ALLOWED_IMAGE_TYPES=image/jpeg,image/png,image/tiff
ALLOWED_VIDEO_TYPES=video/mp4,video/avi
ALLOWED_DOCUMENT_TYPES=application/pdf,text/csv,application/json

# ================================
# üìä OBSERVABILITY & MONITORING
# ================================

# OpenTelemetry
OTEL_ENABLED=true
OTEL_SERVICE_NAME=chip-quality-platform
OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger-collector:14268
OTEL_EXPORTER_OTLP_INSECURE=true
OTEL_TRACE_SAMPLER=parentbased_traceidratio
OTEL_TRACE_SAMPLER_ARG=0.1

# Prometheus Metrics
METRICS_ENABLED=true
METRICS_PORT=9090
METRICS_PATH=/metrics

# Logging Configuration
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_FORMAT=json  # json, plain
LOG_FILE_ENABLED=false
LOG_FILE_PATH=/var/log/chip-quality.log
LOG_MAX_SIZE_MB=100
LOG_BACKUP_COUNT=5

# Structured Logging
STRUCTLOG_ENABLED=true
CORRELATION_ID_HEADER=X-Correlation-ID
REQUEST_ID_HEADER=X-Request-ID

# External Monitoring
GRAFANA_ENABLED=true
GRAFANA_URL=https://grafana.company.com
PROMETHEUS_URL=http://prometheus:9090
LOKI_URL=http://loki:3100

# ================================
# üîß REDIS CONFIGURATION
# ================================

# Redis for Caching and Sessions
REDIS_URL=redis://redis-cluster:6379/0
REDIS_PASSWORD=redis_password_here
REDIS_MAX_CONNECTIONS=20
REDIS_CONNECTION_TIMEOUT=5
REDIS_SOCKET_TIMEOUT=5

# Redis Cluster (if using cluster mode)
REDIS_CLUSTER_ENABLED=false
REDIS_CLUSTER_NODES=redis-node-1:6379,redis-node-2:6379,redis-node-3:6379

# Session Storage
SESSION_REDIS_DB=1
SESSION_EXPIRE_SECONDS=28800  # 8 hours
CACHE_REDIS_DB=2
CACHE_DEFAULT_TTL=300  # 5 minutes

# ================================
# üè• HEALTH CHECKS & CIRCUIT BREAKERS
# ================================

# Health Check Configuration
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30
HEALTH_CHECK_TIMEOUT=10
HEALTH_CHECK_RETRIES=3

# Circuit Breaker Settings
CIRCUIT_BREAKER_ENABLED=true
CIRCUIT_BREAKER_FAILURE_THRESHOLD=5
CIRCUIT_BREAKER_RECOVERY_TIMEOUT=60
CIRCUIT_BREAKER_EXPECTED_EXCEPTION=HTTPException

# Dependency Health Checks
CHECK_DATABASE_HEALTH=true
CHECK_REDIS_HEALTH=true
CHECK_KAFKA_HEALTH=true
CHECK_TRITON_HEALTH=true

# ================================
# üß™ TESTING CONFIGURATION
# ================================

# Test Database
TEST_DB_HOST=postgresql-test
TEST_DB_PORT=5432
TEST_DB_NAME=chip_quality_test
TEST_DB_USER=chip_quality_test_user
TEST_DB_PASSWORD=test_password
TEST_DATABASE_URL=postgresql+asyncpg://chip_quality_test_user:test_password@postgresql-test:5432/chip_quality_test

# Test Data
GENERATE_TEST_DATA=true
TEST_DATA_SCALE=small  # small, medium, large
MOCK_EXTERNAL_SERVICES=true

# Performance Testing
LOAD_TEST_ENABLED=false
LOAD_TEST_CONCURRENT_USERS=100
LOAD_TEST_DURATION_SECONDS=300

# ================================
# üê≥ CONTAINER CONFIGURATION
# ================================

# Docker Compose
COMPOSE_PROJECT_NAME=chip-quality
COMPOSE_PROFILES=api,database,monitoring

# Container Resources
API_GATEWAY_MEMORY_LIMIT=512m
API_GATEWAY_CPU_LIMIT=0.5
INSPECTION_SERVICE_MEMORY_LIMIT=1g
INSPECTION_SERVICE_CPU_LIMIT=1.0

# Container Networking
INTERNAL_NETWORK=chip-quality-internal
EXTERNAL_NETWORK=chip-quality-external
NETWORK_SUBNET=172.20.0.0/16

# ================================
# ‚öôÔ∏è FEATURE FLAGS
# ================================

# Feature Toggles
ENABLE_EXPERIMENTAL_FEATURES=false
ENABLE_BATCH_PROCESSING=true
ENABLE_ASYNC_INFERENCE=true
ENABLE_REAL_TIME_NOTIFICATIONS=true
ENABLE_ADVANCED_ANALYTICS=false

# API Features
ENABLE_GRAPHQL=false
ENABLE_WEBSOCKET=true
ENABLE_RATE_LIMITING=true
ENABLE_CACHING=true

# ML Features
ENABLE_AUTO_RETRAINING=false
ENABLE_MODEL_AB_TESTING=false
ENABLE_CONFIDENCE_LEARNING=true

# ================================
# üåç INTERNATIONALIZATION
# ================================

# Localization
DEFAULT_LANGUAGE=en
SUPPORTED_LANGUAGES=en,es,zh,de,ja
TIMEZONE=UTC
DATE_FORMAT=ISO8601

# ================================
# üìã COMPLIANCE & AUDIT
# ================================

# FDA 21 CFR Part 11
CFR_PART_11_ENABLED=true
DIGITAL_SIGNATURES_ENABLED=false
AUDIT_TRAIL_ENABLED=true
AUDIT_LOG_RETENTION_DAYS=2555  # 7 years

# Data Retention
DATA_RETENTION_POLICY_ENABLED=true
INSPECTION_DATA_RETENTION_YEARS=7
ARTIFACT_DATA_RETENTION_YEARS=5
AUDIT_DATA_RETENTION_YEARS=10

# Privacy & GDPR
GDPR_COMPLIANCE_ENABLED=false
DATA_ANONYMIZATION_ENABLED=false
PERSONAL_DATA_ENCRYPTION=true

# ================================
# üö® ALERTING & NOTIFICATIONS
# ================================

# Email Notifications
SMTP_SERVER=smtp.company.com
SMTP_PORT=587
SMTP_USERNAME=chip-quality-notifications@company.com
SMTP_PASSWORD=smtp_password_here
SMTP_USE_TLS=true

# Slack Integration
SLACK_WEBHOOK_URL=https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK
SLACK_CHANNEL=#manufacturing-alerts
SLACK_ENABLED=true

# PagerDuty Integration
PAGERDUTY_API_KEY=your_pagerduty_api_key
PAGERDUTY_SERVICE_KEY=your_pagerduty_service_key
PAGERDUTY_ENABLED=false

# Alert Thresholds
ALERT_ERROR_RATE_THRESHOLD=0.01  # 1%
ALERT_RESPONSE_TIME_THRESHOLD=1000  # 1 second
ALERT_DISK_USAGE_THRESHOLD=0.8  # 80%
ALERT_MEMORY_USAGE_THRESHOLD=0.85  # 85%

# ================================
# üíª DEVELOPMENT TOOLS
# ================================

# Hot Reloading
AUTO_RELOAD=true
WATCH_FILES=true
RELOAD_DIRS=./app,./services

# Debug Tools
ENABLE_DEBUG_TOOLBAR=false
ENABLE_PROFILING=false
PROFILE_OUTPUT_DIR=/tmp/profiles

# API Documentation
SWAGGER_UI_ENABLED=true
REDOC_ENABLED=true
OPENAPI_URL=/api/v1/openapi.json

# ================================
# üîÑ BACKUP & RECOVERY
# ================================

# Database Backups
BACKUP_ENABLED=true
BACKUP_SCHEDULE=0 2 * * *  # Daily at 2 AM
BACKUP_RETENTION_DAYS=30
BACKUP_STORAGE_TYPE=s3
BACKUP_S3_BUCKET=chip-quality-backups

# Point-in-Time Recovery
PITR_ENABLED=true
WAL_ARCHIVE_ENABLED=true
WAL_ARCHIVE_LOCATION=s3://chip-quality-wal-archive

# Disaster Recovery
DR_ENABLED=false
DR_REGION=us-east-1
DR_RTO_MINUTES=240  # 4 hours
DR_RPO_MINUTES=15   # 15 minutes